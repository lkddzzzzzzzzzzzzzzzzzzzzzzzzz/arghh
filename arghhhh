@echo off
setlocal enabledelayedexpansion

:: Definir caminho para a área de trabalho
set desktop=%USERPROFILE%\Desktop
set dump_file=%desktop%\dump.txt

:: Apagar o arquivo dump.txt se já existir
if exist "%dump_file%" del "%dump_file%"

:: Cabeçalho
echo ============================== >> "%dump_file%"
echo          Dump de Hardware       >> "%dump_file%"
echo ============================== >> "%dump_file%"
echo. >> "%dump_file%"

:: Informações da placa-mãe
echo [PLACA-MÃE] >> "%dump_file%"
wmic baseboard get Manufacturer,Product | findstr /v "Manufacturer" >> "%dump_file%"
echo. >> "%dump_file%"

:: Informações da memória RAM
echo [MEMÓRIA RAM] >> "%dump_file%"
wmic memorychip get Manufacturer,PartNumber | findstr /v "Manufacturer" >> "%dump_file%"
echo. >> "%dump_file%"

:: Informações da placa de vídeo tentando capturar o fabricante real
echo [PLACA DE VÍDEO] >> "%dump_file%"
powershell -Command "Get-WmiObject Win32_VideoController | ForEach-Object { $_.Caption + ' - ' + ($_ | Select-Object -ExpandProperty PNPDeviceID).Split('&')[2] }" >> "%dump_file%"
echo. >> "%dump_file%"

:: Informações do processador
echo [PROCESSADOR] >> "%dump_file%"
wmic cpu get Name | findstr /v "Name" >> "%dump_file%"
echo. >> "%dump_file%"

:: Informações de todos os discos (SSD e HDD)
echo [DISCOS] >> "%dump_file%"
wmic diskdrive get Model,Manufacturer,MediaType | findstr /v "Model" >> "%dump_file%"
echo. >> "%dump_file%"

:: Exibir o arquivo gerado
notepad "%dump_file%"
exit
